<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ProofLocker Globe</title>

  <!-- Mapbox GL JS -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-primary: #0a0a0a;
      --bg-secondary: #111111;
      --bg-card: #1a1a1a;
      --text-primary: #ffffff;
      --text-secondary: #9ca3af;
      --accent-purple: #9333ea;
      --accent-verified: #10b981;
      --accent-disputed: #ef4444;
      --accent-pending: #f59e0b;
      --border: #1f1f1f;
      --shadow-glow: rgba(147, 51, 234, 0.3);
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      overflow: hidden;
    }

    /* Top Header */
    .top-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: rgba(10, 10, 10, 0.9);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      z-index: 1000;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 18px;
      font-weight: 600;
    }

    .logo i {
      color: var(--accent-purple);
    }

    .stats {
      display: flex;
      gap: 32px;
      font-size: 13px;
    }

    .stat {
      display: flex;
      align-items: center;
      gap: 6px;
      color: var(--text-secondary);
    }

    .stat-value {
      color: var(--text-primary);
      font-weight: 600;
    }

    .header-actions {
      display: flex;
      gap: 10px;
    }

    .btn {
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary {
      background: var(--accent-purple);
      color: white;
    }

    .btn-primary:hover {
      background: #7c3aed;
    }

    .btn-ghost {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--border);
    }

    .btn-ghost:hover {
      color: var(--text-primary);
      border-color: var(--accent-purple);
    }

    /* Map Container - Full hero */
    #map {
      position: fixed;
      top: 60px;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
    }

    /* Signals Drawer Toggle */
    .signals-toggle {
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      z-index: 999;
      background: rgba(17, 17, 17, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 12px 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }

    .signals-toggle:hover {
      border-color: var(--accent-purple);
      box-shadow: 0 4px 20px var(--shadow-glow);
    }

    .signals-toggle .badge {
      background: var(--accent-purple);
      color: white;
      border-radius: 12px;
      padding: 2px 8px;
      font-size: 11px;
      font-weight: 600;
    }

    /* Signals Drawer */
    .signals-drawer {
      position: fixed;
      top: 60px;
      right: -440px;
      width: 420px;
      height: calc(100vh - 60px);
      background: rgba(17, 17, 17, 0.98);
      backdrop-filter: blur(30px);
      border-left: 1px solid var(--border);
      z-index: 998;
      transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      box-shadow: -10px 0 30px rgba(0, 0, 0, 0.7);
    }

    .signals-drawer.open {
      right: 0;
    }

    .drawer-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .drawer-title {
      font-size: 16px;
      font-weight: 600;
    }

    .drawer-close {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .drawer-close:hover {
      background: var(--bg-card);
      color: var(--text-primary);
    }

    .drawer-tabs {
      display: flex;
      gap: 4px;
      padding: 16px 20px 0;
      border-bottom: 1px solid var(--border);
    }

    .drawer-tab {
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      cursor: pointer;
      transition: all 0.2s;
    }

    .drawer-tab.active {
      color: var(--accent-purple);
      border-bottom-color: var(--accent-purple);
    }

    .drawer-tab:hover {
      color: var(--text-primary);
    }

    .drawer-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .drawer-content::-webkit-scrollbar {
      width: 6px;
    }

    .drawer-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .drawer-content::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 3px;
    }

    .drawer-content::-webkit-scrollbar-thumb:hover {
      background: var(--accent-purple);
    }

    /* Signal Item */
    .signal-item {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .signal-item:hover {
      border-color: var(--accent-purple);
      background: rgba(147, 51, 234, 0.05);
    }

    .signal-header {
      display: flex;
      gap: 10px;
      margin-bottom: 8px;
    }

    .signal-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--accent-purple);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 14px;
      font-weight: 600;
      flex-shrink: 0;
    }

    .signal-meta {
      flex: 1;
      min-width: 0;
    }

    .signal-source {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .signal-time {
      font-size: 11px;
      color: var(--text-secondary);
    }

    .signal-title {
      font-size: 13px;
      line-height: 1.4;
      color: var(--text-primary);
      margin-bottom: 8px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .signal-tags {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .signal-tag {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 6px;
      background: rgba(147, 51, 234, 0.1);
      color: var(--accent-purple);
    }

    /* Signal Detail View */
    .signal-detail {
      display: none;
    }

    .signal-detail.active {
      display: block;
    }

    .detail-back {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text-secondary);
      font-size: 13px;
      cursor: pointer;
      margin-bottom: 16px;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.2s;
    }

    .detail-back:hover {
      color: var(--text-primary);
      background: var(--bg-card);
    }

    .detail-content {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
    }

    .detail-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .detail-source {
      font-size: 14px;
      font-weight: 600;
    }

    .detail-text {
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-secondary);
      margin-bottom: 16px;
    }

    .detail-actions {
      display: flex;
      gap: 8px;
    }

    /* Draft Claim Item */
    .draft-item {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-left: 3px solid var(--accent-purple);
      border-radius: 10px;
      padding: 14px;
      margin-bottom: 12px;
    }

    .draft-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--text-primary);
    }

    .draft-meta {
      display: flex;
      gap: 12px;
      margin-bottom: 10px;
      font-size: 12px;
    }

    .draft-meta-item {
      display: flex;
      align-items: center;
      gap: 4px;
      color: var(--text-secondary);
    }

    .draft-confidence {
      color: var(--accent-verified);
      font-weight: 600;
    }

    .draft-actions {
      display: flex;
      gap: 8px;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 12px;
      border-radius: 6px;
    }

    /* Locked Item */
    .locked-item {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 10px;
    }

    .locked-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }

    .locked-title {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      flex: 1;
    }

    .locked-status {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 6px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .status-verified {
      background: rgba(16, 185, 129, 0.15);
      color: var(--accent-verified);
    }

    .status-pending {
      background: rgba(245, 158, 11, 0.15);
      color: var(--accent-pending);
    }

    .status-disputed {
      background: rgba(239, 68, 68, 0.15);
      color: var(--accent-disputed);
    }

    .locked-footer {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: var(--text-secondary);
    }

    /* Map Controls */
    .map-controls {
      position: fixed;
      top: 80px;
      left: 20px;
      z-index: 900;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .map-control-btn {
      width: 40px;
      height: 40px;
      background: rgba(17, 17, 17, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      color: var(--text-secondary);
    }

    .map-control-btn:hover {
      border-color: var(--accent-purple);
      color: var(--accent-purple);
    }

    .map-control-btn.active {
      background: var(--accent-purple);
      color: white;
      border-color: var(--accent-purple);
    }

    /* Vignette */
    .vignette {
      position: fixed;
      top: 60px;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      background: radial-gradient(ellipse at center, transparent 0%, rgba(147, 51, 234, 0.03) 60%, rgba(0, 0, 0, 0.2) 100%);
      z-index: 700;
    }

    /* Map Popups */
    .mapboxgl-popup-content {
      background: var(--bg-card) !important;
      border: 1px solid var(--border) !important;
      border-radius: 12px !important;
      padding: 16px !important;
      min-width: 260px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8) !important;
    }

    .mapboxgl-popup-close-button {
      color: var(--text-secondary) !important;
      font-size: 18px !important;
    }

    .popup-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .popup-meta {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }

    .popup-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 12px;
    }

    .popup-stat {
      background: rgba(147, 51, 234, 0.1);
      padding: 8px;
      border-radius: 8px;
      text-align: center;
    }

    .popup-stat-value {
      font-size: 16px;
      font-weight: 700;
      color: var(--accent-purple);
    }

    .popup-stat-label {
      font-size: 10px;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    .popup-actions {
      display: flex;
      gap: 8px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .stats {
        display: none;
      }

      .signals-drawer {
        width: 100%;
        right: -100%;
      }

      .signals-toggle {
        right: 16px;
      }
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .empty-state p {
      font-size: 13px;
    }

    /* Hide Mapbox attribution */
    .mapboxgl-ctrl-bottom-left,
    .mapboxgl-ctrl-bottom-right {
      display: none;
    }

    .mapboxgl-ctrl-logo {
      display: none !important;
    }
  </style>
</head>
<body>

  <!-- Top Header -->
  <header class="top-header">
    <div class="logo">
      <i class="fas fa-lock"></i>
      ProofLocker
    </div>

    <div class="stats">
      <div class="stat">
        <span class="stat-value">1,247</span>
        <span>claims</span>
      </div>
      <div class="stat">
        <span class="stat-value">82%</span>
        <span>accuracy</span>
      </div>
      <div class="stat">
        <span class="stat-value">@VerifierPro</span>
        <span>top user</span>
      </div>
    </div>

    <div class="header-actions">
      <button class="btn btn-ghost">
        <i class="fas fa-trophy"></i>
        Leaderboard
      </button>
      <button class="btn btn-primary">
        <i class="fas fa-plus"></i>
        New Claim
      </button>
    </div>
  </header>

  <!-- Map -->
  <div id="map"></div>
  <div class="vignette"></div>

  <!-- Map Controls -->
  <div class="map-controls">
    <div class="map-control-btn active" title="All Claims" onclick="toggleLayer('all')">
      <i class="fas fa-globe"></i>
    </div>
    <div class="map-control-btn" title="Verified Only" onclick="toggleLayer('verified')">
      <i class="fas fa-check-circle"></i>
    </div>
    <div class="map-control-btn" title="Heatmap" onclick="toggleHeatmap()">
      <i class="fas fa-fire"></i>
    </div>
    <div class="map-control-btn" title="Reset View" onclick="resetView()">
      <i class="fas fa-redo"></i>
    </div>
  </div>

  <!-- Signals Toggle -->
  <div class="signals-toggle" onclick="toggleDrawer()">
    <i class="fas fa-satellite-dish"></i>
    Signals
    <span class="badge">12</span>
  </div>

  <!-- Signals Drawer -->
  <aside class="signals-drawer" id="signalsDrawer">
    <div class="drawer-header">
      <div class="drawer-title">Signals</div>
      <button class="drawer-close" onclick="toggleDrawer()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="drawer-tabs">
      <button class="drawer-tab active" onclick="switchTab('signals')">Signals</button>
      <button class="drawer-tab" onclick="switchTab('drafts')">Draft Claims</button>
      <button class="drawer-tab" onclick="switchTab('locked')">Locked</button>
    </div>

    <div class="drawer-content">
      <!-- Signals List -->
      <div id="signalsTab" class="tab-content">
        <!-- Dynamically filled -->
      </div>

      <!-- Signal Detail -->
      <div id="signalDetail" class="signal-detail">
        <!-- Dynamically filled -->
      </div>

      <!-- Drafts Tab -->
      <div id="draftsTab" class="tab-content" style="display: none;">
        <!-- Dynamically filled -->
      </div>

      <!-- Locked Tab -->
      <div id="lockedTab" class="tab-content" style="display: none;">
        <!-- Dynamically filled -->
      </div>
    </div>
  </aside>

  <script>
    // Mapbox Config
    mapboxgl.accessToken = "pk.eyJ1IjoicHJvb2Zsb2NrZXIiLCJhIjoiY21sYjBxcTAwMGVoYzNlczI4YWlzampqZyJ9.nY-yqSucTzvNyK1qDCq9rQ";

    // Mock Data
    const mockClaims = [
      { id: 1, title: "Election outcome in District 5", location: [2.3522, 48.8566], city: "Paris", status: "verified", user: "@DataMaster", reputation: 92, stake: 500, confidence: 87, hash: "0x7a8f...d3c2" },
      { id: 2, title: "GDP growth Q1 2024", location: [-74.006, 40.7128], city: "New York", status: "pending", user: "@EconWatcher", reputation: 78, stake: 750, confidence: 65, hash: "0x9b2e...a1f4" },
      { id: 3, title: "Tech merger timeline", location: [139.6917, 35.6895], city: "Tokyo", status: "pending", user: "@TechInsider", reputation: 85, stake: 1000, confidence: 73, hash: "0x3d4f...b6e8" },
      { id: 4, title: "Climate summit outcome", location: [-0.1276, 51.5074], city: "London", status: "verified", user: "@ClimatePro", reputation: 88, stake: 600, confidence: 91, hash: "0x5c7a...e2d9" },
      { id: 5, title: "Policy implementation date", location: [116.4074, 39.9042], city: "Beijing", status: "disputed", user: "@PolicyWatch", reputation: 71, stake: 400, confidence: 58, hash: "0x8e1b...f3c7" }
    ];

    const mockSignals = [
      { id: 1, source: "Bellingcat", handle: "B", content: "Investigation reveals coordinated disinformation across 12 countries", time: "2h", tags: ["Investigation", "Evidence"] },
      { id: 2, source: "IntelCrab", handle: "I", content: "Satellite imagery confirms infrastructure changes in disputed region", time: "4h", tags: ["Satellite", "OSINT"] },
      { id: 3, source: "OSINT Tech", handle: "O", content: "Public records show pattern inconsistencies in recent claims", time: "6h", tags: ["Analysis", "Timeline"] },
      { id: 4, source: "Aurora Intel", handle: "A", content: "Crowdsourced verification completed: 87% confidence level", time: "8h", tags: ["Verification", "Confidence"] },
      { id: 5, source: "Bellingcat", handle: "B", content: "Video authentication techniques published in new forensics report", time: "10h", tags: ["Forensics", "Video"] },
      { id: 6, source: "OSINT Tech", handle: "O", content: "Supply chain tracking reveals significant pattern deviations", time: "12h", tags: ["Supply Chain", "Tracking"] }
    ];

    const mockDrafts = [
      { id: 1, title: "Infrastructure changes will be confirmed by independent sources", outcome: "Verification within 72h", timeframe: "3 days", confidence: 85 },
      { id: 2, title: "Disinformation campaign attribution completed", outcome: "Full attribution report", timeframe: "1 week", confidence: 78 },
      { id: 3, title: "Supply chain disruption impacts Q1 deliveries", outcome: "15% delay confirmed", timeframe: "30 days", confidence: 72 }
    ];

    const mockLocked = [
      { id: 1, title: "Election outcome prediction District 5", status: "verified", time: "2d ago", hash: "0x7a8f...d3c2" },
      { id: 2, title: "GDP growth forecast Q1", status: "pending", time: "1d ago", hash: "0x9b2e...a1f4" },
      { id: 3, title: "Tech merger approval timeline", status: "pending", time: "8h ago", hash: "0x3d4f...b6e8" },
      { id: 4, title: "Climate summit resolution", status: "verified", time: "3d ago", hash: "0x5c7a...e2d9" }
    ];

    // Initialize Map
    const map = new mapboxgl.Map({
      container: "map",
      style: "mapbox://styles/mapbox/dark-v11",
      projection: "globe",
      center: [15, 35],
      zoom: 1.3,
      antialias: true,
      attributionControl: false
    });

    let heatmapVisible = false;

    map.on("style.load", () => {
      map.setFog({
        "range": [0.5, 10],
        "color": "#000000",
        "horizon-blend": 0.05,
        "high-color": "#0a0a0a",
        "space-color": "#000000",
        "star-intensity": 0.15
      });

      const claimsGeoJSON = {
        type: "FeatureCollection",
        features: mockClaims.map(claim => ({
          type: "Feature",
          geometry: { type: "Point", coordinates: claim.location },
          properties: { ...claim }
        }))
      };

      map.addSource("claims", {
        type: "geojson",
        data: claimsGeoJSON
      });

      map.addLayer({
        id: "claims-glow",
        type: "circle",
        source: "claims",
        paint: {
          "circle-radius": ["interpolate", ["linear"], ["zoom"], 1, 25, 5, 90, 10, 130],
          "circle-color": ["match", ["get", "status"], "verified", "#10b981", "disputed", "#ef4444", "#f59e0b"],
          "circle-opacity": 0.2,
          "circle-blur": 1
        }
      });

      map.addLayer({
        id: "claims-core",
        type: "circle",
        source: "claims",
        paint: {
          "circle-radius": ["interpolate", ["linear"], ["zoom"], 1, 8, 5, 16, 10, 24],
          "circle-color": ["match", ["get", "status"], "verified", "#10b981", "disputed", "#ef4444", "#f59e0b"],
          "circle-opacity": 0.9,
          "circle-stroke-width": 2,
          "circle-stroke-color": "#ffffff",
          "circle-stroke-opacity": 0.8
        }
      });

      map.addLayer({
        id: "claims-heatmap",
        type: "heatmap",
        source: "claims",
        paint: {
          "heatmap-weight": ["get", "confidence"],
          "heatmap-intensity": 1,
          "heatmap-color": ["interpolate", ["linear"], ["heatmap-density"], 0, "rgba(0,0,255,0)", 0.2, "#9333ea", 0.4, "#a78bfa", 0.6, "#c084fc", 0.8, "#e9d5ff", 1, "#ffffff"],
          "heatmap-radius": 50,
          "heatmap-opacity": 0.8
        },
        layout: { "visibility": "none" }
      });

      map.on("click", "claims-core", (e) => {
        const props = e.features[0].properties;
        const popupHTML = `
          <div class="popup-title">${props.title}</div>
          <div class="popup-meta">
            ${props.city} • ${props.user} • Rep: ${props.reputation}
          </div>
          <div class="popup-stats">
            <div class="popup-stat">
              <div class="popup-stat-value">${props.stake}</div>
              <div class="popup-stat-label">Staked</div>
            </div>
            <div class="popup-stat">
              <div class="popup-stat-value">${props.confidence}%</div>
              <div class="popup-stat-label">Confidence</div>
            </div>
          </div>
          <div class="popup-actions">
            <button class="btn btn-primary btn-sm" onclick="viewEvidence(${props.id})">Evidence</button>
            <button class="btn btn-ghost btn-sm" onclick="challengeClaim(${props.id})">Challenge</button>
          </div>
        `;

        new mapboxgl.Popup({ offset: 25 })
          .setLngLat(e.features[0].geometry.coordinates)
          .setHTML(popupHTML)
          .addTo(map);
      });

      map.on("mouseenter", "claims-core", () => {
        map.getCanvas().style.cursor = "pointer";
      });

      map.on("mouseleave", "claims-core", () => {
        map.getCanvas().style.cursor = "";
      });

      map.on("idle", () => {
        if (map.getZoom() < 2) {
          map.rotateTo(map.getBearing() + 10, { duration: 60000 });
        }
      });
    });

    // UI Functions
    function toggleDrawer() {
      document.getElementById("signalsDrawer").classList.toggle("open");
    }

    function switchTab(tab) {
      document.querySelectorAll('.drawer-tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');

      document.getElementById('signalsTab').style.display = 'none';
      document.getElementById('signalDetail').style.display = 'none';
      document.getElementById('draftsTab').style.display = 'none';
      document.getElementById('lockedTab').style.display = 'none';

      if (tab === 'signals') {
        document.getElementById('signalsTab').style.display = 'block';
      } else if (tab === 'drafts') {
        document.getElementById('draftsTab').style.display = 'block';
      } else if (tab === 'locked') {
        document.getElementById('lockedTab').style.display = 'block';
      }
    }

    function renderSignals() {
      const container = document.getElementById('signalsTab');
      container.innerHTML = mockSignals.map(s => `
        <div class="signal-item" onclick="showSignalDetail(${s.id})">
          <div class="signal-header">
            <div class="signal-icon">${s.handle}</div>
            <div class="signal-meta">
              <div class="signal-source">${s.source}</div>
              <div class="signal-time">${s.time} ago</div>
            </div>
          </div>
          <div class="signal-title">${s.content}</div>
          <div class="signal-tags">
            ${s.tags.map(tag => `<span class="signal-tag">#${tag}</span>`).join('')}
          </div>
        </div>
      `).join('');
    }

    function showSignalDetail(id) {
      const signal = mockSignals.find(s => s.id === id);
      document.getElementById('signalsTab').style.display = 'none';
      const detail = document.getElementById('signalDetail');
      detail.innerHTML = `
        <div class="detail-back" onclick="backToSignals()">
          <i class="fas fa-arrow-left"></i> Back
        </div>
        <div class="detail-content">
          <div class="detail-header">
            <div class="signal-icon">${signal.handle}</div>
            <div>
              <div class="detail-source">${signal.source}</div>
              <div class="signal-time">${signal.time} ago</div>
            </div>
          </div>
          <div class="detail-text">${signal.content}</div>
          <div class="signal-tags" style="margin-bottom: 16px;">
            ${signal.tags.map(tag => `<span class="signal-tag">#${tag}</span>`).join('')}
          </div>
          <div class="detail-actions">
            <button class="btn btn-primary btn-sm" onclick="createClaimFromSignal(${signal.id})">
              <i class="fas fa-plus"></i> Create Claim
            </button>
            <button class="btn btn-ghost btn-sm" onclick="window.open('https://x.com/${signal.source}', '_blank')">
              <i class="fas fa-external-link-alt"></i> View Source
            </button>
          </div>
        </div>
      `;
      detail.style.display = 'block';
    }

    function backToSignals() {
      document.getElementById('signalDetail').style.display = 'none';
      document.getElementById('signalsTab').style.display = 'block';
    }

    function renderDrafts() {
      const container = document.getElementById('draftsTab');
      container.innerHTML = mockDrafts.map(d => `
        <div class="draft-item">
          <div class="draft-title">${d.title}</div>
          <div class="draft-meta">
            <div class="draft-meta-item">
              <i class="fas fa-calendar"></i> ${d.timeframe}
            </div>
            <div class="draft-meta-item">
              <i class="fas fa-chart-line"></i>
              <span class="draft-confidence">${d.confidence}%</span>
            </div>
          </div>
          <div class="draft-actions">
            <button class="btn btn-primary btn-sm" onclick="lockClaim(${d.id})">
              <i class="fas fa-lock"></i> Lock Claim
            </button>
            <button class="btn btn-ghost btn-sm">Edit</button>
          </div>
        </div>
      `).join('');
    }

    function renderLocked() {
      const container = document.getElementById('lockedTab');
      container.innerHTML = mockLocked.map(l => `
        <div class="locked-item">
          <div class="locked-header">
            <div class="locked-title">${l.title}</div>
            <span class="locked-status status-${l.status}">${l.status}</span>
          </div>
          <div class="locked-footer">
            <span>${l.time}</span>
            <span>${l.hash}</span>
          </div>
        </div>
      `).join('');
    }

    function toggleLayer(type) {
      if (type === 'all') {
        map.setFilter("claims-core", null);
        map.setFilter("claims-glow", null);
      } else if (type === 'verified') {
        map.setFilter("claims-core", ["==", ["get", "status"], "verified"]);
        map.setFilter("claims-glow", ["==", ["get", "status"], "verified"]);
      }
    }

    function toggleHeatmap() {
      heatmapVisible = !heatmapVisible;
      map.setLayoutProperty("claims-heatmap", "visibility", heatmapVisible ? "visible" : "none");
      map.setLayoutProperty("claims-core", "visibility", heatmapVisible ? "none" : "visible");
      map.setLayoutProperty("claims-glow", "visibility", heatmapVisible ? "none" : "visible");
    }

    function resetView() {
      map.flyTo({ center: [15, 35], zoom: 1.3, duration: 2000 });
    }

    function viewEvidence(id) {
      alert(`Viewing evidence for claim #${id}`);
    }

    function challengeClaim(id) {
      alert(`Challenge claim #${id}`);
    }

    function createClaimFromSignal(id) {
      alert(`Creating claim from signal #${id}`);
    }

    function lockClaim(id) {
      alert(`Locking claim #${id}`);
    }

    // Initialize
    renderSignals();
    renderDrafts();
    renderLocked();
  </script>

</body>
</html>