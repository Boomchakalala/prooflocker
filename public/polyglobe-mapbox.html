<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ProofLocker Globe - Verifiable Predictions Worldwide</title>

  <!-- Mapbox GL JS v2.15.0 -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>

  <!-- Google Fonts: Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      /* Updated color scheme - deep navy theme */
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --bg-overlay: rgba(15, 23, 42, 0.95);
      --text-primary: #f8fafc;
      --text-secondary: #94a3b8;
      --text-muted: #64748b;

      /* Accountability colors */
      --color-verified: #14b8a6;    /* Teal for positive/verified/high-rep */
      --color-disputed: #ef4444;    /* Crimson for negative/disputed */
      --color-pending: #f59e0b;     /* Amber for pending */
      --color-neutral: #6b7280;     /* Gray for neutral/void */

      /* UI elements */
      --border-subtle: rgba(148, 163, 184, 0.1);
      --border-medium: rgba(148, 163, 184, 0.2);
      --backdrop-blur: blur(20px);
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: #000000;
      color: var(--text-primary);
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
    }

    /* ============================================
       HEADER - Slim, semi-transparent with stats
       ============================================ */
    .main-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: var(--bg-overlay);
      backdrop-filter: var(--backdrop-blur);
      border-bottom: 1px solid var(--border-subtle);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      z-index: 1000;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 32px;
    }

    .logo-link {
      display: flex;
      align-items: center;
      text-decoration: none;
    }

    .logo-link img {
      height: 36px;
      width: auto;
    }

    .header-tagline {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
      letter-spacing: 0.02em;
      display: none;
    }

    @media (min-width: 1024px) {
      .header-tagline {
        display: block;
      }
    }

    .header-stats {
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-secondary);
    }

    .stat-value {
      font-weight: 600;
      color: var(--text-primary);
    }

    .stat-icon {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.2s ease;
      text-decoration: none;
    }

    .btn-icon {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }

    .btn-primary {
      background: var(--color-verified);
      color: #0f172a;
    }

    .btn-primary:hover {
      background: #0d9488;
      transform: translateY(-1px);
    }

    .btn-ghost {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--border-medium);
    }

    .btn-ghost:hover {
      color: var(--text-primary);
      border-color: var(--color-verified);
      background: rgba(20, 184, 166, 0.1);
    }

    .user-rep-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(20, 184, 166, 0.15);
      border: 1px solid rgba(20, 184, 166, 0.3);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      color: var(--color-verified);
    }

    /* ============================================
       MAP CONTAINER - Full screen below header
       ============================================ */
    #map {
      position: fixed;
      top: 56px;
      left: 0;
      right: 360px;
      bottom: 0;
    }

    /* Hide Mapbox branding */
    .mapboxgl-ctrl-bottom-left,
    .mapboxgl-ctrl-bottom-right,
    .mapboxgl-ctrl-logo {
      display: none !important;
    }

    /* ============================================
       MAP CONTROLS - Top right corner
       ============================================ */
    .map-controls {
      position: fixed;
      top: 76px;
      right: 20px;
      z-index: 900;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .control-btn {
      width: 42px;
      height: 42px;
      background: var(--bg-overlay);
      backdrop-filter: var(--backdrop-blur);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-secondary);
    }

    .control-btn:hover {
      border-color: var(--color-verified);
      color: var(--color-verified);
      background: rgba(20, 184, 166, 0.1);
    }

    .control-btn.active {
      background: var(--color-verified);
      color: #0f172a;
      border-color: var(--color-verified);
    }

    .control-icon {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }

    /* ============================================
       RIGHT SIDEBAR - Always visible with tabs
       ============================================ */
    .right-sidebar {
      position: fixed;
      top: 56px;
      right: 0;
      width: 360px;
      height: calc(100vh - 56px);
      background: var(--bg-overlay);
      backdrop-filter: var(--backdrop-blur);
      border-left: 1px solid var(--border-subtle);
      z-index: 950;
      display: flex;
      flex-direction: column;
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid var(--border-subtle);
    }

    .sidebar-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .tab-btn {
      flex: 1;
      padding: 8px 16px;
      background: transparent;
      border: 1px solid var(--border-medium);
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-btn:hover {
      color: var(--text-primary);
      border-color: var(--color-verified);
    }

    .tab-btn.active {
      background: var(--color-verified);
      color: #0f172a;
      border-color: var(--color-verified);
    }

    .tab-btn.osint-tab.active {
      background: var(--color-disputed);
      border-color: var(--color-disputed);
    }

    .sidebar-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 12px;
    }

    .sidebar-filters {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .filter-chip {
      padding: 6px 12px;
      border-radius: 16px;
      font-size: 12px;
      font-weight: 500;
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--border-medium);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .filter-chip:hover,
    .filter-chip.active {
      background: rgba(20, 184, 166, 0.15);
      color: var(--color-verified);
      border-color: var(--color-verified);
    }

    .sidebar-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .sidebar-content::-webkit-scrollbar {
      width: 4px;
    }

    .sidebar-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .sidebar-content::-webkit-scrollbar-thumb {
      background: var(--border-medium);
      border-radius: 2px;
    }

    /* Claim card in sidebar */
    .claim-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      padding: 14px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .claim-card:hover {
      border-color: var(--color-verified);
      background: rgba(20, 184, 166, 0.05);
    }

    .claim-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .claim-submitter {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
    }

    .submitter-handle {
      font-weight: 600;
      color: var(--text-primary);
    }

    .submitter-rep {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 2px 6px;
      background: rgba(20, 184, 166, 0.15);
      border-radius: 10px;
      font-size: 11px;
      font-weight: 600;
      color: var(--color-verified);
    }

    .rep-icon {
      width: 10px;
      height: 10px;
    }

    .status-badge {
      padding: 3px 8px;
      border-radius: 10px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    .status-badge.verified {
      background: rgba(20, 184, 166, 0.2);
      color: var(--color-verified);
    }

    .status-badge.disputed {
      background: rgba(239, 68, 68, 0.2);
      color: var(--color-disputed);
    }

    .status-badge.pending {
      background: rgba(245, 158, 11, 0.2);
      color: var(--color-pending);
    }

    .status-badge.void {
      background: rgba(107, 114, 128, 0.2);
      color: var(--color-neutral);
    }

    .claim-text {
      font-size: 13px;
      line-height: 1.5;
      color: var(--text-primary);
      margin-bottom: 10px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .claim-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 11px;
      color: var(--text-muted);
    }

    .confidence-bar {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .confidence-value {
      font-weight: 600;
      color: var(--text-secondary);
    }

    .confidence-progress {
      width: 40px;
      height: 4px;
      background: rgba(148, 163, 184, 0.2);
      border-radius: 2px;
      overflow: hidden;
    }

    .confidence-fill {
      height: 100%;
      background: var(--color-verified);
      border-radius: 2px;
    }

    /* OSINT News items */
    .osint-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-left: 3px solid var(--color-disputed);
      border-radius: 10px;
      padding: 14px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .osint-item:hover {
      border-color: var(--color-disputed);
      background: rgba(239, 68, 68, 0.05);
    }

    .osint-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .osint-source {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
    }

    .osint-source-name {
      font-weight: 600;
      color: var(--text-primary);
    }

    .osint-time {
      font-size: 11px;
      color: var(--text-muted);
    }

    .osint-text {
      font-size: 13px;
      line-height: 1.5;
      color: var(--text-primary);
      margin-bottom: 8px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .osint-tags {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .osint-tag {
      padding: 3px 8px;
      background: rgba(239, 68, 68, 0.15);
      border-radius: 10px;
      font-size: 10px;
      font-weight: 600;
      color: var(--color-disputed);
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* ============================================
       MAPBOX POPUP - Clean card with actions
       ============================================ */
    .mapboxgl-popup-content {
      background: var(--bg-overlay) !important;
      backdrop-filter: var(--backdrop-blur);
      border: 1px solid var(--border-medium) !important;
      border-radius: 12px !important;
      padding: 18px !important;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5) !important;
      min-width: 320px;
      max-width: 400px;
    }

    .mapboxgl-popup-close-button {
      color: var(--text-secondary) !important;
      font-size: 20px !important;
      padding: 8px !important;
      right: 6px !important;
      top: 6px !important;
    }

    .mapboxgl-popup-close-button:hover {
      color: var(--text-primary) !important;
      background: rgba(148, 163, 184, 0.1) !important;
      border-radius: 6px;
    }

    .mapboxgl-popup-tip {
      display: none;
    }

    .popup-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .popup-submitter {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-subtle);
    }

    .popup-handle {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .popup-rep {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      background: rgba(20, 184, 166, 0.15);
      border-radius: 10px;
      font-size: 11px;
      font-weight: 600;
      color: var(--color-verified);
    }

    .popup-info-grid {
      display: grid;
      gap: 10px;
      margin-bottom: 14px;
    }

    .popup-info-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 12px;
    }

    .popup-info-label {
      color: var(--text-muted);
    }

    .popup-info-value {
      font-weight: 600;
      color: var(--text-primary);
    }

    .popup-confidence {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      background: rgba(20, 184, 166, 0.1);
      border-radius: 8px;
      margin-bottom: 14px;
    }

    .popup-confidence-label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .popup-confidence-bar {
      flex: 1;
      height: 6px;
      background: rgba(148, 163, 184, 0.2);
      border-radius: 3px;
      overflow: hidden;
    }

    .popup-confidence-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--color-verified), #0d9488);
      border-radius: 3px;
    }

    .popup-confidence-value {
      font-size: 14px;
      font-weight: 700;
      color: var(--color-verified);
    }

    .popup-evidence {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      background: rgba(148, 163, 184, 0.05);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      font-size: 11px;
      color: var(--text-secondary);
      margin-bottom: 14px;
      text-decoration: none;
      transition: all 0.2s ease;
    }

    .popup-evidence:hover {
      border-color: var(--color-verified);
      color: var(--color-verified);
      background: rgba(20, 184, 166, 0.05);
    }

    .popup-evidence-icon {
      width: 14px;
      height: 14px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }

    .popup-actions {
      display: flex;
      gap: 8px;
    }

    .popup-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
    }

    .popup-btn-support {
      background: rgba(20, 184, 166, 0.15);
      color: var(--color-verified);
      border: 1px solid transparent;
    }

    .popup-btn-support:hover {
      background: rgba(20, 184, 166, 0.25);
      border-color: var(--color-verified);
    }

    .popup-btn-challenge {
      background: rgba(239, 68, 68, 0.15);
      color: var(--color-disputed);
      border: 1px solid transparent;
    }

    .popup-btn-challenge:hover {
      background: rgba(239, 68, 68, 0.25);
      border-color: var(--color-disputed);
    }

    .popup-btn-icon {
      width: 14px;
      height: 14px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }

    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 768px) {
      .header-stats {
        display: none;
      }

      .right-sidebar {
        width: 100%;
        right: -100%;
        transition: right 0.3s ease;
      }

      .right-sidebar.open {
        right: 0;
      }

      #map {
        right: 0;
      }

      .mapboxgl-popup-content {
        min-width: 280px;
      }
    }
  </style>
</head>
<body>

  <!-- ============================================
       HEADER
       ============================================ -->
  <header class="main-header">
    <div class="header-left">
      <a href="/" class="logo-link">
        <img src="/logos/prooflocker-logo-dark.svg" alt="ProofLocker">
      </a>
      <span class="header-tagline">Verifiable Predictions Worldwide</span>
    </div>

    <div class="header-stats">
      <div class="stat-item">
        <svg class="stat-icon" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
        </svg>
        <span>Active: <span class="stat-value" id="activeClaims">512</span></span>
      </div>
      <div class="stat-item">
        <svg class="stat-icon" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span>Accuracy: <span class="stat-value" id="globalAccuracy">79%</span></span>
      </div>
    </div>

    <div class="header-actions">
      <button class="btn btn-ghost mobile-sidebar-toggle" onclick="toggleSidebar()" title="View Claims List" style="display: none;">
        <svg class="btn-icon" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>

      <a href="/lock" class="btn btn-primary">
        <svg class="btn-icon" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
        </svg>
        Submit Claim
      </a>

      <div class="user-rep-badge" title="Your Reputation Score">
        <svg class="rep-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
        <span>84</span>
      </div>
    </div>
  </header>

  <!-- ============================================
       MAP CONTAINER
       ============================================ -->
  <div id="map"></div>

  <!-- ============================================
       MAP CONTROLS
       ============================================ -->
  <div class="map-controls">
    <button class="control-btn active" id="claimsToggle" onclick="toggleClaimsLayer()" title="Toggle Claims">
      <svg class="control-icon" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
      </svg>
    </button>

    <button class="control-btn" id="heatmapToggle" onclick="toggleHeatmap()" title="Toggle Heatmap">
      <svg class="control-icon" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z" />
      </svg>
    </button>

    <button class="control-btn" onclick="resetMapView()" title="Reset View">
      <svg class="control-icon" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
    </button>
  </div>

  <!-- ============================================
       RIGHT SIDEBAR - Always visible with tabs
       ============================================ -->
  <aside class="right-sidebar" id="rightSidebar">
    <div class="sidebar-header">
      <div class="sidebar-tabs">
        <button class="tab-btn active" onclick="switchTab('claims')">
          <svg style="width: 14px; height: 14px; display: inline-block; vertical-align: middle; margin-right: 4px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
          </svg>
          Claims <span id="claimsTabCount">(20)</span>
        </button>
        <button class="tab-btn osint-tab" onclick="switchTab('osint')">
          <svg style="width: 14px; height: 14px; display: inline-block; vertical-align: middle; margin-right: 4px;" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
          OSINT <span id="osintTabCount">(15)</span>
        </button>
      </div>
      <div class="sidebar-filters" id="claimsFilters">
        <button class="filter-chip active" data-filter="active">Active</button>
        <button class="filter-chip" data-filter="high-confidence">High Confidence</button>
        <button class="filter-chip" data-filter="my-predictions">My Predictions</button>
      </div>
    </div>
    <div class="sidebar-content">
      <!-- Claims Tab Content -->
      <div class="tab-content active" id="claimsTab">
        <div id="claimsList">
          <!-- Dynamically populated -->
        </div>
      </div>
      <!-- OSINT Tab Content -->
      <div class="tab-content" id="osintTab">
        <div id="osintList">
          <!-- Dynamically populated -->
        </div>
      </div>
    </div>
  </aside>

  <script>
    // ============================================
    // MAPBOX CONFIGURATION
    // ============================================
    mapboxgl.accessToken = "pk.eyJ1IjoicHJvb2Zsb2NrZXIiLCJhIjoiY21sYjBxcTAwMGVoYzNlczI4YWlzampqZyJ9.nY-yqSucTzvNyK1qDCq9rQ";

    // ============================================
    // MOCK DATA - 20 Claims with Realistic Locations
    // ============================================
    const claimsData = [
      { id: 1, claim: "US Presidential Election 2024 will have record voter turnout", lat: 40.7128, lng: -74.0060, status: "verified", submitter: "@politicalanalyst", rep: 92, confidence: 87, lockedDate: "2024-01-15", outcome: "true" },
      { id: 2, claim: "Global semiconductor shortage will ease by Q3 2025", lat: 37.5665, lng: 126.9780, status: "pending", submitter: "@techinsider", rep: 78, confidence: 64, lockedDate: "2024-01-20", outcome: null },
      { id: 3, claim: "UK will implement new AI regulation framework", lat: 51.5074, lng: -0.1278, status: "verified", submitter: "@policyexpert", rep: 88, confidence: 91, lockedDate: "2024-01-10", outcome: "true" },
      { id: 4, claim: "Bitcoin will reach $100K by end of 2025", lat: 35.6762, lng: 139.6503, status: "disputed", submitter: "@cryptotrader", rep: 54, confidence: 42, lockedDate: "2024-01-25", outcome: "false" },
      { id: 5, claim: "Climate summit will achieve binding emissions targets", lat: 48.8566, lng: 2.3522, status: "pending", submitter: "@climatewatch", rep: 85, confidence: 71, lockedDate: "2024-02-01", outcome: null },
      { id: 6, claim: "Major tech merger will be blocked by regulators", lat: 37.7749, lng: -122.4194, status: "void", submitter: "@antitrust_observer", rep: 76, confidence: 58, lockedDate: "2024-01-28", outcome: "void" },
      { id: 7, claim: "Australian housing market will correct by 15%", lat: -33.8688, lng: 151.2093, status: "pending", submitter: "@marketanalyst", rep: 81, confidence: 68, lockedDate: "2024-02-03", outcome: null },
      { id: 8, claim: "India GDP growth will exceed 7% in FY2025", lat: 28.6139, lng: 77.2090, status: "verified", submitter: "@economicdata", rep: 94, confidence: 89, lockedDate: "2024-01-18", outcome: "true" },
      { id: 9, claim: "EU will expand Digital Services Act enforcement", lat: 50.8503, lng: 4.3517, status: "pending", submitter: "@euregulatorywatch", rep: 72, confidence: 76, lockedDate: "2024-02-05", outcome: null },
      { id: 10, claim: "Brazilian elections will see runoff in October", lat: -15.8267, lng: -47.9218, status: "disputed", submitter: "@latampolitics", rep: 67, confidence: 51, lockedDate: "2024-01-30", outcome: "false" },
      { id: 11, claim: "Middle East peace talks will resume before June", lat: 31.7683, lng: 35.2137, status: "pending", submitter: "@diplomaticsource", rep: 79, confidence: 62, lockedDate: "2024-02-02", outcome: null },
      { id: 12, claim: "Toronto real estate will stabilize in Q2", lat: 43.6532, lng: -79.3832, status: "pending", submitter: "@cdnhousing", rep: 83, confidence: 73, lockedDate: "2024-01-22", outcome: null },
      { id: 13, claim: "German coalition will complete full term", lat: 52.5200, lng: 13.4050, status: "verified", submitter: "@berlinpolitik", rep: 90, confidence: 84, lockedDate: "2024-01-12", outcome: "true" },
      { id: 14, claim: "Singapore fintech sector will grow 25% YoY", lat: 1.3521, lng: 103.8198, status: "pending", submitter: "@asiafinance", rep: 86, confidence: 79, lockedDate: "2024-01-27", outcome: null },
      { id: 15, claim: "Mexico manufacturing output will exceed US imports", lat: 19.4326, lng: -99.1332, status: "disputed", submitter: "@trademetrics", rep: 62, confidence: 48, lockedDate: "2024-02-04", outcome: "false" },
      { id: 16, claim: "Russian oil exports will shift to Asian markets", lat: 55.7558, lng: 37.6173, status: "verified", submitter: "@energyintel", rep: 87, confidence: 82, lockedDate: "2024-01-16", outcome: "true" },
      { id: 17, claim: "South African power grid will achieve stability", lat: -33.9249, lng: 18.4241, status: "pending", submitter: "@africanenergy", rep: 74, confidence: 66, lockedDate: "2024-01-29", outcome: null },
      { id: 18, claim: "Dubai property prices will rise 12% in 2025", lat: 25.2048, lng: 55.2708, status: "pending", submitter: "@gulfpropertytracker", rep: 77, confidence: 69, lockedDate: "2024-02-01", outcome: null },
      { id: 19, claim: "Stockholm will implement congestion pricing expansion", lat: 59.3293, lng: 18.0686, status: "verified", submitter: "@nordictransport", rep: 82, confidence: 88, lockedDate: "2024-01-14", outcome: "true" },
      { id: 20, claim: "Argentine peso stabilization plan will succeed", lat: -34.6037, lng: -58.3816, status: "disputed", submitter: "@latamecon", rep: 58, confidence: 44, lockedDate: "2024-02-06", outcome: "false" }
    ];

    // ============================================
    // STATE MANAGEMENT
    // ============================================
    let heatmapVisible = false;
    let claimsLayerVisible = true;
    let osintLayerVisible = true;
    let currentFilter = 'active';
    let currentTab = 'claims';

    // ============================================
    // MOCK OSINT DATA - 15 News Signals
    // ============================================
    const osintData = [
      { id: 1, title: "Satellite imagery confirms infrastructure changes in disputed region", source: "Bellingcat", lat: 50.4501, lng: 30.5234, timestamp: "2h ago", tags: ["OSINT", "Verification"] },
      { id: 2, title: "Investigation reveals coordinated disinformation network", source: "IntelCrab", lat: 52.5200, lng: 13.4050, timestamp: "4h ago", tags: ["Disinformation", "Investigation"] },
      { id: 3, title: "Video authentication confirms timeline discrepancies", source: "Aurora Intel", lat: 48.8566, lng: 2.3522, timestamp: "6h ago", tags: ["Video Analysis", "Timeline"] },
      { id: 4, title: "Supply chain tracking reveals unusual pattern deviations", source: "OSINT Tech", lat: 35.6762, lng: 139.6503, timestamp: "8h ago", tags: ["Supply Chain", "Anomaly"] },
      { id: 5, title: "Election monitoring data shows voting irregularities", source: "Bellingcat", lat: -15.8267, lng: -47.9218, timestamp: "10h ago", tags: ["Elections", "Monitoring"] },
      { id: 6, title: "Energy infrastructure damage confirmed via commercial satellites", source: "IntelCrab", lat: 55.7558, lng: 37.6173, timestamp: "12h ago", tags: ["Infrastructure", "Satellites"] },
      { id: 7, title: "Financial transaction patterns suggest laundering network", source: "Aurora Intel", lat: 40.7128, lng: -74.0060, timestamp: "14h ago", tags: ["Finance", "Investigation"] },
      { id: 8, title: "Military equipment movement tracked across border regions", source: "OSINT Tech", lat: 31.7683, lng: 35.2137, timestamp: "16h ago", tags: ["Military", "Movement"] },
      { id: 9, title: "Social media manipulation campaign targets regional elections", source: "Bellingcat", lat: 28.6139, lng: 77.2090, timestamp: "18h ago", tags: ["Social Media", "Elections"] },
      { id: 10, title: "Cybersecurity breach exposes government communications", source: "IntelCrab", lat: 51.5074, lng: -0.1278, timestamp: "20h ago", tags: ["Cybersecurity", "Breach"] },
      { id: 11, title: "Public records analysis reveals pattern inconsistencies", source: "Aurora Intel", lat: -33.8688, lng: 151.2093, timestamp: "22h ago", tags: ["Records", "Analysis"] },
      { id: 12, title: "Crowdsourced verification completed with high confidence", source: "OSINT Tech", lat: 1.3521, lng: 103.8198, timestamp: "1d ago", tags: ["Crowdsourced", "Verification"] },
      { id: 13, title: "Maritime tracking data shows unusual vessel patterns", source: "Bellingcat", lat: 25.2048, lng: 55.2708, timestamp: "1d ago", tags: ["Maritime", "Tracking"] },
      { id: 14, title: "Environmental monitoring detects pollution spike", source: "IntelCrab", lat: 37.7749, lng: -122.4194, timestamp: "1d ago", tags: ["Environment", "Monitoring"] },
      { id: 15, title: "Forensic analysis confirms document authenticity", source: "Aurora Intel", lat: 59.3293, lng: 18.0686, timestamp: "2d ago", tags: ["Forensics", "Documents"] }
    ];

    // ============================================
    // INITIALIZE MAP
    // ============================================
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/dark-v11',
      projection: 'globe',
      center: [15, 35],
      zoom: 1.8,
      pitch: 0,
      bearing: 0,
      antialias: true,
      attributionControl: false
    });

    // ============================================
    // MAP STYLE LOAD EVENT
    // ============================================
    map.on('style.load', () => {
      // Configure atmosphere & fog for "from space" effect
      map.setFog({
        range: [0.5, 10],
        color: '#000000',
        'horizon-blend': 0.05,
        'high-color': '#0a0a0a',
        'space-color': '#000000',
        'star-intensity': 0.2
      });

      // Create GeoJSON features from claims data
      const claimsFeatures = claimsData.map(claim => ({
        type: 'Feature',
        geometry: {
          type: 'Point',
          coordinates: [claim.lng, claim.lat]
        },
        properties: {
          id: claim.id,
          claim: claim.claim,
          status: claim.status,
          submitter: claim.submitter,
          rep: claim.rep,
          confidence: claim.confidence,
          lockedDate: claim.lockedDate,
          outcome: claim.outcome
        }
      }));

      // Add claims source with clustering
      map.addSource('claims', {
        type: 'geojson',
        data: {
          type: 'FeatureCollection',
          features: claimsFeatures
        },
        cluster: true,
        clusterMaxZoom: 5,
        clusterRadius: 50
      });

      // Add OSINT source with clustering
      const osintFeatures = osintData.map(item => ({
        type: 'Feature',
        geometry: {
          type: 'Point',
          coordinates: [item.lng, item.lat]
        },
        properties: {
          id: item.id,
          title: item.title,
          source: item.source,
          timestamp: item.timestamp,
          tags: JSON.stringify(item.tags)
        }
      }));

      map.addSource('osint', {
        type: 'geojson',
        data: {
          type: 'FeatureCollection',
          features: osintFeatures
        },
        cluster: true,
        clusterMaxZoom: 5,
        clusterRadius: 60
      });

      // ============================================
      // OSINT LAYERS (RED - underneath claims)
      // ============================================
      // OSINT Cluster glow
      map.addLayer({
        id: 'osint-clusters-glow',
        type: 'circle',
        source: 'osint',
        filter: ['has', 'point_count'],
        paint: {
          'circle-color': '#ef4444',
          'circle-radius': ['step', ['get', 'point_count'], 28, 5, 38, 10, 48],
          'circle-blur': 0.8,
          'circle-opacity': 0.2
        }
      });

      // OSINT Cluster core
      map.addLayer({
        id: 'osint-clusters-core',
        type: 'circle',
        source: 'osint',
        filter: ['has', 'point_count'],
        paint: {
          'circle-color': '#ef4444',
          'circle-radius': ['step', ['get', 'point_count'], 18, 5, 24, 10, 32],
          'circle-opacity': 0.85,
          'circle-stroke-width': 2,
          'circle-stroke-color': '#f8fafc',
          'circle-stroke-opacity': 0.6
        }
      });

      // OSINT Cluster count
      map.addLayer({
        id: 'osint-cluster-count',
        type: 'symbol',
        source: 'osint',
        filter: ['has', 'point_count'],
        layout: {
          'text-field': '{point_count_abbreviated}',
          'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],
          'text-size': 12
        },
        paint: {
          'text-color': '#ffffff'
        }
      });

      // OSINT Points glow
      map.addLayer({
        id: 'osint-points-glow',
        type: 'circle',
        source: 'osint',
        filter: ['!', ['has', 'point_count']],
        paint: {
          'circle-color': '#ef4444',
          'circle-radius': 18,
          'circle-blur': 0.7,
          'circle-opacity': 0.25
        }
      });

      // OSINT Points core
      map.addLayer({
        id: 'osint-points-core',
        type: 'circle',
        source: 'osint',
        filter: ['!', ['has', 'point_count']],
        paint: {
          'circle-color': '#ef4444',
          'circle-radius': 9,
          'circle-opacity': 0.9,
          'circle-stroke-width': 2,
          'circle-stroke-color': '#f8fafc',
          'circle-stroke-opacity': 0.8
        }
      });

      // ============================================
      // CLUSTER LAYERS
      // ============================================
      // Cluster glow
      map.addLayer({
        id: 'claims-clusters-glow',
        type: 'circle',
        source: 'claims',
        filter: ['has', 'point_count'],
        paint: {
          'circle-color': '#14b8a6',
          'circle-radius': ['step', ['get', 'point_count'], 25, 5, 35, 10, 45],
          'circle-blur': 0.8,
          'circle-opacity': 0.2
        }
      });

      // Cluster core
      map.addLayer({
        id: 'claims-clusters-core',
        type: 'circle',
        source: 'claims',
        filter: ['has', 'point_count'],
        paint: {
          'circle-color': '#14b8a6',
          'circle-radius': ['step', ['get', 'point_count'], 15, 5, 20, 10, 28],
          'circle-opacity': 0.9,
          'circle-stroke-width': 2,
          'circle-stroke-color': '#f8fafc',
          'circle-stroke-opacity': 0.7
        }
      });

      // Cluster count labels
      map.addLayer({
        id: 'claims-cluster-count',
        type: 'symbol',
        source: 'claims',
        filter: ['has', 'point_count'],
        layout: {
          'text-field': '{point_count_abbreviated}',
          'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],
          'text-size': 12
        },
        paint: {
          'text-color': '#0f172a'
        }
      });

      // ============================================
      // UNCLUSTERED POINT LAYERS (Color by status)
      // ============================================
      // Glow layer
      map.addLayer({
        id: 'claims-points-glow',
        type: 'circle',
        source: 'claims',
        filter: ['!', ['has', 'point_count']],
        paint: {
          'circle-color': [
            'match',
            ['get', 'status'],
            'verified', '#14b8a6',
            'disputed', '#ef4444',
            'void', '#6b7280',
            '#f59e0b'  // pending (default)
          ],
          'circle-radius': 16,
          'circle-blur': 0.7,
          'circle-opacity': 0.25
        }
      });

      // Core layer
      map.addLayer({
        id: 'claims-points-core',
        type: 'circle',
        source: 'claims',
        filter: ['!', ['has', 'point_count']],
        paint: {
          'circle-color': [
            'match',
            ['get', 'status'],
            'verified', '#14b8a6',
            'disputed', '#ef4444',
            'void', '#6b7280',
            '#f59e0b'  // pending
          ],
          'circle-radius': 8,
          'circle-opacity': 0.95,
          'circle-stroke-width': 2,
          'circle-stroke-color': '#f8fafc',
          'circle-stroke-opacity': 0.9
        }
      });

      // ============================================
      // HEATMAP LAYER (Hidden by default)
      // ============================================
      map.addLayer({
        id: 'claims-heatmap',
        type: 'heatmap',
        source: 'claims',
        maxzoom: 9,
        paint: {
          'heatmap-weight': ['interpolate', ['linear'], ['get', 'confidence'], 0, 0, 100, 1],
          'heatmap-intensity': ['interpolate', ['linear'], ['zoom'], 0, 1, 9, 3],
          'heatmap-color': [
            'interpolate',
            ['linear'],
            ['heatmap-density'],
            0, 'rgba(20, 184, 166, 0)',
            0.2, 'rgba(20, 184, 166, 0.2)',
            0.4, 'rgba(20, 184, 166, 0.4)',
            0.6, 'rgba(245, 158, 11, 0.5)',
            0.8, 'rgba(239, 68, 68, 0.6)',
            1, 'rgba(239, 68, 68, 0.8)'
          ],
          'heatmap-radius': ['interpolate', ['linear'], ['zoom'], 0, 15, 9, 30],
          'heatmap-opacity': 0.7
        },
        layout: {
          visibility: 'none'
        }
      });

      // ============================================
      // INTERACTION HANDLERS
      // ============================================
      // Hover cursor
      ['claims-clusters-core', 'claims-points-core', 'osint-clusters-core', 'osint-points-core'].forEach(layer => {
        map.on('mouseenter', layer, () => {
          map.getCanvas().style.cursor = 'pointer';
        });
        map.on('mouseleave', layer, () => {
          map.getCanvas().style.cursor = '';
        });
      });

      // Click OSINT cluster to expand
      map.on('click', 'osint-clusters-core', (e) => {
        const features = map.queryRenderedFeatures(e.point, {
          layers: ['osint-clusters-core']
        });
        const clusterId = features[0].properties.cluster_id;
        map.getSource('osint').getClusterExpansionZoom(clusterId, (err, zoom) => {
          if (err) return;
          map.easeTo({
            center: features[0].geometry.coordinates,
            zoom: zoom,
            duration: 800
          });
        });
      });

      // Click OSINT point to show popup
      map.on('click', 'osint-points-core', (e) => {
        const props = e.features[0].properties;
        const osint = osintData.find(o => o.id === props.id);

        if (!osint) return;

        const tags = JSON.parse(props.tags || '[]');
        const popupHTML = `
          <div class="popup-title">${osint.title}</div>

          <div class="popup-submitter" style="border-bottom: 1px solid var(--border-subtle); padding-bottom: 10px; margin-bottom: 10px;">
            <span class="popup-handle">${osint.source}</span>
            <span style="font-size: 11px; color: var(--text-muted);">${osint.timestamp}</span>
          </div>

          <div style="display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 12px;">
            ${tags.map(tag => `<span class="osint-tag">${tag}</span>`).join('')}
          </div>

          <button class="popup-btn popup-btn-support" onclick="window.open('https://example.com/source', '_blank'); return false;" style="width: 100%;">
            <svg class="popup-btn-icon" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
            View Source
          </button>
        `;

        new mapboxgl.Popup({ offset: 25, closeButton: true, maxWidth: '400px' })
          .setLngLat(e.features[0].geometry.coordinates)
          .setHTML(popupHTML)
          .addTo(map);
      });

      // Click claim cluster to expand
      map.on('click', 'claims-clusters-core', (e) => {
        const features = map.queryRenderedFeatures(e.point, {
          layers: ['claims-clusters-core']
        });
        const clusterId = features[0].properties.cluster_id;
        map.getSource('claims').getClusterExpansionZoom(clusterId, (err, zoom) => {
          if (err) return;
          map.easeTo({
            center: features[0].geometry.coordinates,
            zoom: zoom,
            duration: 800
          });
        });
      });

      // Click unclustered point to show popup
      map.on('click', 'claims-points-core', (e) => {
        const props = e.features[0].properties;
        const claim = claimsData.find(c => c.id === props.id);

        if (!claim) return;

        const statusBadge = `<span class="status-badge ${claim.status}">${claim.status.toUpperCase()}</span>`;
        const evidenceHash = `0x${Math.random().toString(16).substr(2, 12)}...`;

        const popupHTML = `
          <div class="popup-title">${claim.claim}</div>

          <div class="popup-submitter">
            <span class="popup-handle">${claim.submitter}</span>
            <div class="popup-rep">
              <svg class="rep-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
              ${claim.rep}
            </div>
            ${statusBadge}
          </div>

          <div class="popup-info-grid">
            <div class="popup-info-item">
              <span class="popup-info-label">Locked</span>
              <span class="popup-info-value">${claim.lockedDate}</span>
            </div>
            ${claim.outcome ? `
            <div class="popup-info-item">
              <span class="popup-info-label">Outcome</span>
              <span class="popup-info-value">${claim.outcome.toUpperCase()}</span>
            </div>
            ` : ''}
          </div>

          <div class="popup-confidence">
            <span class="popup-confidence-label">Confidence</span>
            <div class="popup-confidence-bar">
              <div class="popup-confidence-fill" style="width: ${claim.confidence}%"></div>
            </div>
            <span class="popup-confidence-value">${claim.confidence}%</span>
          </div>

          <a href="#" class="popup-evidence" onclick="alert('View on blockchain: ${evidenceHash}'); return false;">
            <svg class="popup-evidence-icon" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
            </svg>
            <span>View Proof: ${evidenceHash}</span>
          </a>

          <div class="popup-actions">
            <button class="popup-btn popup-btn-support" onclick="alert('Support this claim'); return false;">
              <svg class="popup-btn-icon" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              Support
            </button>
            <button class="popup-btn popup-btn-challenge" onclick="alert('Challenge this claim'); return false;">
              <svg class="popup-btn-icon" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              Challenge
            </button>
          </div>
        `;

        new mapboxgl.Popup({ offset: 25, closeButton: true, maxWidth: '400px' })
          .setLngLat(e.features[0].geometry.coordinates)
          .setHTML(popupHTML)
          .addTo(map);
      });

      // Slow globe rotation when idle
      map.on('idle', () => {
        if (map.getZoom() < 2.5 && !map.isMoving()) {
          map.rotateTo(map.getBearing() + 15, { duration: 120000 });
        }
      });
    });

    // ============================================
    // UI CONTROLS
    // ============================================
    function switchTab(tab) {
      currentTab = tab;

      // Update tab buttons
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      if (tab === 'claims') {
        document.querySelectorAll('.tab-btn')[0].classList.add('active');
        document.getElementById('claimsFilters').style.display = 'flex';
      } else {
        document.querySelectorAll('.tab-btn')[1].classList.add('active');
        document.getElementById('claimsFilters').style.display = 'none';
      }

      // Update tab content
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.getElementById(tab + 'Tab').classList.add('active');

      // Render appropriate list
      if (tab === 'osint') {
        renderOsintList();
      }
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('rightSidebar');
      sidebar.classList.toggle('open');
    }

    function toggleClaimsLayer() {
      claimsLayerVisible = !claimsLayerVisible;
      const visibility = claimsLayerVisible ? 'visible' : 'none';

      ['claims-clusters-glow', 'claims-clusters-core', 'claims-cluster-count',
       'claims-points-glow', 'claims-points-core'].forEach(layer => {
        map.setLayoutProperty(layer, 'visibility', visibility);
      });

      document.getElementById('claimsToggle').classList.toggle('active', claimsLayerVisible);
    }

    function toggleOsintLayer() {
      osintLayerVisible = !osintLayerVisible;
      const visibility = osintLayerVisible ? 'visible' : 'none';

      ['osint-clusters-glow', 'osint-clusters-core', 'osint-cluster-count',
       'osint-points-glow', 'osint-points-core'].forEach(layer => {
        map.setLayoutProperty(layer, 'visibility', visibility);
      });

      document.getElementById('osintToggle').classList.toggle('active', osintLayerVisible);
    }

    function toggleHeatmap() {
      heatmapVisible = !heatmapVisible;
      const visibility = heatmapVisible ? 'visible' : 'none';
      map.setLayoutProperty('claims-heatmap', 'visibility', visibility);
      document.getElementById('heatmapToggle').classList.toggle('active', heatmapVisible);
    }

    function resetMapView() {
      map.flyTo({
        center: [15, 35],
        zoom: 1.8,
        pitch: 0,
        bearing: 0,
        duration: 2000
      });
    }

    function flyToClaim(lng, lat) {
      map.flyTo({
        center: [lng, lat],
        zoom: 6,
        duration: 1500
      });
    }

    function flyToOsint(lng, lat) {
      map.flyTo({
        center: [lng, lat],
        zoom: 6,
        duration: 1500
      });
    }

    // ============================================
    // SIDEBAR CLAIMS LIST
    // ============================================
    function renderClaimsList() {
      const container = document.getElementById('claimsList');

      let filteredClaims = claimsData;
      if (currentFilter === 'active') {
        filteredClaims = claimsData.filter(c => c.status === 'pending');
      } else if (currentFilter === 'high-confidence') {
        filteredClaims = claimsData.filter(c => c.confidence >= 75);
      } else if (currentFilter === 'my-predictions') {
        // Mock: show claims by current user
        filteredClaims = claimsData.filter(c => c.submitter === '@politicalanalyst');
      }

      container.innerHTML = filteredClaims.map(claim => `
        <div class="claim-card" onclick="flyToClaim(${claim.lng}, ${claim.lat})">
          <div class="claim-card-header">
            <div class="claim-submitter">
              <span class="submitter-handle">${claim.submitter}</span>
              <div class="submitter-rep">
                <svg class="rep-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
                ${claim.rep}
              </div>
            </div>
            <span class="status-badge ${claim.status}">${claim.status}</span>
          </div>
          <div class="claim-text">${claim.claim}</div>
          <div class="claim-meta">
            <span>${claim.lockedDate}</span>
            <div class="confidence-bar">
              <span class="confidence-value">${claim.confidence}%</span>
              <div class="confidence-progress">
                <div class="confidence-fill" style="width: ${claim.confidence}%"></div>
              </div>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Filter chips
    document.querySelectorAll('.filter-chip').forEach(chip => {
      chip.addEventListener('click', (e) => {
        document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
        e.target.classList.add('active');
        currentFilter = e.target.dataset.filter;
        renderClaimsList();
      });
    });

    // ============================================
    // INITIALIZE
    // ============================================
    renderClaimsList();

    // Update stats periodically (mock)
    setInterval(() => {
      const activeClaims = Math.floor(500 + Math.random() * 50);
      const accuracy = Math.floor(75 + Math.random() * 10);
      document.getElementById('activeClaims').textContent = activeClaims;
      document.getElementById('globalAccuracy').textContent = accuracy + '%';
    }, 30000);
  </script>

</body>
</html>
