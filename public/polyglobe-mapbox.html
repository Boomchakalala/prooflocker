<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ProofLocker Globe - Digital Evidence & Accountability</title>

  <!-- Mapbox GL JS -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>

  <!-- Chart.js for dashboards -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-primary: #001F3F;
      --bg-secondary: #002B4D;
      --bg-card: #003355;
      --text-primary: #FFFFFF;
      --text-secondary: #B0BEC5;
      --accent-verified: #28A745;
      --accent-disputed: #DC3545;
      --accent-pending: #FFC107;
      --accent-purple: #9333ea;
      --border-subtle: #1A4D6F;
      --shadow-glow: rgba(147, 51, 234, 0.3);
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      overflow: hidden;
    }

    /* Top Header Dashboard */
    .top-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 70px;
      background: rgba(0, 31, 63, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 2px solid var(--accent-purple);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 30px;
      z-index: 1000;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo-icon {
      font-size: 32px;
      color: var(--accent-purple);
    }

    .logo-text {
      font-size: 24px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent-purple) 0%, #c084fc 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .global-stats {
      display: flex;
      gap: 40px;
      align-items: center;
    }

    .stat-item {
      text-align: center;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--accent-purple);
    }

    .stat-label {
      font-size: 11px;
      text-transform: uppercase;
      color: var(--text-secondary);
      margin-top: 4px;
      letter-spacing: 0.5px;
    }

    .header-actions {
      display: flex;
      gap: 12px;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: var(--accent-purple);
      color: white;
    }

    .btn-primary:hover {
      background: #7c3aed;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px var(--shadow-glow);
    }

    .btn-secondary {
      background: transparent;
      border: 1px solid var(--accent-purple);
      color: var(--accent-purple);
    }

    .btn-secondary:hover {
      background: rgba(147, 51, 234, 0.1);
    }

    /* Main Container */
    #map {
      position: fixed;
      top: 70px;
      left: 0;
      right: 0;
      bottom: 280px;
      width: 100%;
    }

    /* Sidebar - Claims Feed */
    .sidebar {
      position: fixed;
      top: 70px;
      right: -420px;
      width: 420px;
      height: calc(100vh - 350px);
      background: rgba(0, 43, 77, 0.95);
      backdrop-filter: blur(15px);
      border-left: 2px solid var(--accent-purple);
      transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 900;
      overflow-y: auto;
      box-shadow: -4px 0 20px rgba(0, 0, 0, 0.5);
    }

    .sidebar.open {
      right: 0;
    }

    .sidebar-toggle {
      position: fixed;
      top: 120px;
      right: 20px;
      width: 50px;
      height: 50px;
      background: var(--accent-purple);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 1001;
      box-shadow: 0 4px 15px var(--shadow-glow);
      transition: all 0.3s ease;
    }

    .sidebar-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 25px var(--shadow-glow);
    }

    .sidebar-toggle i {
      color: white;
      font-size: 20px;
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid var(--border-subtle);
      position: sticky;
      top: 0;
      background: rgba(0, 43, 77, 0.98);
      backdrop-filter: blur(10px);
      z-index: 10;
    }

    .sidebar-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .filter-tabs {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .filter-tab {
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 12px;
      background: transparent;
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-tab.active {
      background: var(--accent-purple);
      color: white;
      border-color: var(--accent-purple);
    }

    .claims-list {
      padding: 15px;
    }

    .claim-card {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .claim-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--accent-pending);
    }

    .claim-card.verified::before {
      background: var(--accent-verified);
    }

    .claim-card.disputed::before {
      background: var(--accent-disputed);
    }

    .claim-card:hover {
      border-color: var(--accent-purple);
      box-shadow: 0 4px 20px rgba(147, 51, 234, 0.2);
      transform: translateY(-2px);
    }

    .claim-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .claim-title {
      font-size: 15px;
      font-weight: 600;
      line-height: 1.4;
      flex: 1;
    }

    .claim-status {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      margin-left: 10px;
    }

    .status-pending {
      background: rgba(255, 193, 7, 0.15);
      color: var(--accent-pending);
    }

    .status-verified {
      background: rgba(40, 167, 69, 0.15);
      color: var(--accent-verified);
    }

    .status-disputed {
      background: rgba(220, 53, 69, 0.15);
      color: var(--accent-disputed);
    }

    .claim-meta {
      display: flex;
      gap: 15px;
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 12px;
    }

    .claim-meta-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .reputation-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      border-radius: 10px;
      background: rgba(147, 51, 234, 0.15);
      color: var(--accent-purple);
      font-size: 11px;
      font-weight: 600;
    }

    .claim-evidence {
      margin-top: 10px;
      display: flex;
      gap: 8px;
    }

    .evidence-btn {
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 11px;
      background: rgba(147, 51, 234, 0.1);
      border: 1px solid var(--accent-purple);
      color: var(--accent-purple);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .evidence-btn:hover {
      background: rgba(147, 51, 234, 0.2);
    }

    /* OSINT Panel */
    .osint-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 280px;
      background: rgba(0, 31, 63, 0.95);
      backdrop-filter: blur(15px);
      border-top: 2px solid var(--accent-purple);
      z-index: 800;
      overflow: hidden;
    }

    .osint-header {
      padding: 15px 30px;
      border-bottom: 1px solid var(--border-subtle);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .osint-title {
      font-size: 16px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .osint-title i {
      color: var(--accent-purple);
    }

    .osint-sources {
      display: flex;
      gap: 8px;
      font-size: 11px;
      color: var(--text-secondary);
    }

    .osint-feed {
      display: flex;
      gap: 15px;
      padding: 15px 30px;
      overflow-x: auto;
      overflow-y: hidden;
      height: calc(280px - 60px);
    }

    .osint-feed::-webkit-scrollbar {
      height: 8px;
    }

    .osint-feed::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }

    .osint-feed::-webkit-scrollbar-thumb {
      background: var(--accent-purple);
      border-radius: 4px;
    }

    .osint-card {
      flex: 0 0 350px;
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 16px;
      transition: all 0.3s ease;
    }

    .osint-card:hover {
      border-color: var(--accent-purple);
      box-shadow: 0 4px 20px rgba(147, 51, 234, 0.2);
    }

    .osint-card-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .osint-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--accent-purple);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
    }

    .osint-author {
      flex: 1;
    }

    .osint-handle {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .osint-timestamp {
      font-size: 11px;
      color: var(--text-secondary);
    }

    .osint-content {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text-primary);
      margin-bottom: 12px;
    }

    .osint-tags {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .osint-tag {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      background: rgba(147, 51, 234, 0.1);
      color: var(--accent-purple);
      border: 1px solid rgba(147, 51, 234, 0.3);
    }

    .osint-actions {
      margin-top: 12px;
      display: flex;
      gap: 8px;
    }

    .osint-btn {
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 11px;
      background: transparent;
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .osint-btn:hover {
      border-color: var(--accent-purple);
      color: var(--accent-purple);
    }

    /* Map Popups */
    .mapboxgl-popup-content {
      background: var(--bg-card) !important;
      border: 2px solid var(--accent-purple) !important;
      border-radius: 12px !important;
      padding: 20px !important;
      min-width: 280px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.7) !important;
    }

    .mapboxgl-popup-close-button {
      color: var(--text-primary) !important;
      font-size: 20px !important;
      padding: 5px !important;
    }

    .popup-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 12px;
    }

    .popup-info {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 12px;
    }

    .popup-stats {
      display: flex;
      gap: 20px;
      margin-bottom: 12px;
    }

    .popup-stat {
      flex: 1;
      text-align: center;
      padding: 10px;
      background: rgba(147, 51, 234, 0.1);
      border-radius: 8px;
    }

    .popup-stat-value {
      font-size: 20px;
      font-weight: 700;
      color: var(--accent-purple);
    }

    .popup-stat-label {
      font-size: 11px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .popup-actions {
      display: flex;
      gap: 8px;
    }

    .popup-btn {
      flex: 1;
      padding: 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
    }

    .popup-btn-primary {
      background: var(--accent-purple);
      color: white;
    }

    .popup-btn-secondary {
      background: transparent;
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
    }

    /* Globe Enhancements */
    .globe-controls {
      position: fixed;
      top: 90px;
      left: 20px;
      z-index: 900;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .globe-control-btn {
      width: 45px;
      height: 45px;
      background: rgba(0, 43, 77, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid var(--accent-purple);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: var(--accent-purple);
    }

    .globe-control-btn:hover {
      background: rgba(147, 51, 234, 0.2);
      box-shadow: 0 4px 15px var(--shadow-glow);
    }

    .globe-control-btn.active {
      background: var(--accent-purple);
      color: white;
    }

    /* Leaderboard Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .modal.open {
      display: flex;
    }

    .modal-content {
      background: var(--bg-secondary);
      border: 2px solid var(--accent-purple);
      border-radius: 16px;
      padding: 30px;
      width: 90%;
      max-width: 700px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.8);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .modal-close {
      font-size: 28px;
      cursor: pointer;
      color: var(--text-secondary);
    }

    .leaderboard-table {
      width: 100%;
      border-collapse: collapse;
    }

    .leaderboard-table thead {
      background: rgba(147, 51, 234, 0.1);
      border-bottom: 2px solid var(--accent-purple);
    }

    .leaderboard-table th {
      padding: 12px;
      text-align: left;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--accent-purple);
    }

    .leaderboard-table td {
      padding: 14px 12px;
      border-bottom: 1px solid var(--border-subtle);
      font-size: 14px;
    }

    .leaderboard-table tr:hover {
      background: rgba(147, 51, 234, 0.05);
    }

    .rank-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: var(--accent-purple);
      color: white;
      font-weight: 700;
      font-size: 14px;
    }

    .rank-badge.top {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #000;
    }

    /* Vignette overlay */
    .vignette {
      position: fixed;
      top: 70px;
      left: 0;
      right: 0;
      bottom: 280px;
      pointer-events: none;
      background: radial-gradient(ellipse at center, transparent 0%, rgba(88, 28, 135, 0.05) 50%, rgba(0, 0, 0, 0.3) 100%);
      z-index: 700;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .global-stats {
        display: none;
      }

      .sidebar {
        width: 100%;
        right: -100%;
      }

      .osint-panel {
        height: 200px;
      }

      #map {
        bottom: 200px;
      }
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 10px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--accent-purple);
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <!-- Top Header Dashboard -->
  <header class="top-header">
    <div class="logo-section">
      <i class="fas fa-lock logo-icon"></i>
      <div class="logo-text">ProofLocker</div>
    </div>

    <div class="global-stats">
      <div class="stat-item">
        <div class="stat-value" id="totalClaims">1,247</div>
        <div class="stat-label">Active Claims</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="accuracy">82%</div>
        <div class="stat-label">Avg Accuracy</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="topUser">@VerifierPro</div>
        <div class="stat-label">Top Rep User</div>
      </div>
    </div>

    <div class="header-actions">
      <button class="btn btn-secondary" onclick="openLeaderboard()">
        <i class="fas fa-trophy"></i> Leaderboard
      </button>
      <button class="btn btn-primary">
        <i class="fas fa-plus"></i> New Claim
      </button>
    </div>
  </header>

  <!-- Globe Controls -->
  <div class="globe-controls">
    <div class="globe-control-btn active" title="Show All Claims" onclick="toggleLayer('all')">
      <i class="fas fa-globe"></i>
    </div>
    <div class="globe-control-btn" title="Verified Only" onclick="toggleLayer('verified')">
      <i class="fas fa-check-circle"></i>
    </div>
    <div class="globe-control-btn" title="Heatmap View" onclick="toggleHeatmap()">
      <i class="fas fa-fire"></i>
    </div>
    <div class="globe-control-btn" title="Reset View" onclick="resetView()">
      <i class="fas fa-redo"></i>
    </div>
  </div>

  <!-- Map Container -->
  <div id="map"></div>
  <div class="vignette"></div>

  <!-- Sidebar Toggle -->
  <div class="sidebar-toggle" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
  </div>

  <!-- Claims Sidebar -->
  <aside class="sidebar" id="claimsSidebar">
    <div class="sidebar-header">
      <div class="sidebar-title">
        <i class="fas fa-list"></i>
        Active Claims Feed
      </div>
      <div class="filter-tabs">
        <button class="filter-tab active" onclick="filterClaims('all')">All</button>
        <button class="filter-tab" onclick="filterClaims('verified')">Verified</button>
        <button class="filter-tab" onclick="filterClaims('pending')">Pending</button>
        <button class="filter-tab" onclick="filterClaims('disputed')">Disputed</button>
      </div>
    </div>

    <div class="claims-list" id="claimsList">
      <!-- Claims will be dynamically inserted here -->
    </div>
  </aside>

  <!-- OSINT Panel -->
  <section class="osint-panel">
    <div class="osint-header">
      <div class="osint-title">
        <i class="fas fa-satellite-dish"></i>
        Live OSINT Intelligence Feed
      </div>
      <div class="osint-sources">
        Sources: @bellingcat, @IntelCrab, @OSINTtechnical, @AuroraIntel
      </div>
    </div>

    <div class="osint-feed" id="osintFeed">
      <!-- OSINT cards will be dynamically inserted here -->
    </div>
  </section>

  <!-- Leaderboard Modal -->
  <div class="modal" id="leaderboardModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title"><i class="fas fa-trophy"></i> Top Verifiers Leaderboard</div>
        <div class="modal-close" onclick="closeLeaderboard()">&times;</div>
      </div>

      <table class="leaderboard-table">
        <thead>
          <tr>
            <th>Rank</th>
            <th>User</th>
            <th>Score</th>
            <th>Claims Resolved</th>
            <th>Accuracy</th>
          </tr>
        </thead>
        <tbody id="leaderboardBody">
          <!-- Leaderboard data will be inserted here -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Mapbox Configuration
    mapboxgl.accessToken = "pk.eyJ1IjoicHJvb2Zsb2NrZXIiLCJhIjoiY21sYjBxcTAwMGVoYzNlczI4YWlzampqZyJ9.nY-yqSucTzvNyK1qDCq9rQ";

    // Mock Data - Claims
    const mockClaims = [
      {
        id: 1,
        title: "Election outcome prediction in District 5",
        location: [2.3522, 48.8566],
        city: "Paris",
        status: "verified",
        user: "@DataMaster",
        reputation: 92,
        stake: 500,
        confidence: 87,
        timestamp: "2024-02-01T10:30:00Z",
        hash: "0x7a8f...d3c2"
      },
      {
        id: 2,
        title: "Economic forecast: GDP growth Q1 2024",
        location: [-74.006, 40.7128],
        city: "New York",
        status: "pending",
        user: "@EconWatcher",
        reputation: 78,
        stake: 750,
        confidence: 65,
        timestamp: "2024-02-03T14:20:00Z",
        hash: "0x9b2e...a1f4"
      },
      {
        id: 3,
        title: "Tech merger approval timeline prediction",
        location: [139.6917, 35.6895],
        city: "Tokyo",
        status: "pending",
        user: "@TechInsider",
        reputation: 85,
        stake: 1000,
        confidence: 73,
        timestamp: "2024-02-04T08:15:00Z",
        hash: "0x3d4f...b6e8"
      },
      {
        id: 4,
        title: "Climate summit outcome prediction",
        location: [-0.1276, 51.5074],
        city: "London",
        status: "verified",
        user: "@ClimatePro",
        reputation: 88,
        stake: 600,
        confidence: 91,
        timestamp: "2024-02-02T16:45:00Z",
        hash: "0x5c7a...e2d9"
      },
      {
        id: 5,
        title: "Policy change implementation date",
        location: [116.4074, 39.9042],
        city: "Beijing",
        status: "disputed",
        user: "@PolicyWatch",
        reputation: 71,
        stake: 400,
        confidence: 58,
        timestamp: "2024-02-05T11:30:00Z",
        hash: "0x8e1b...f3c7"
      },
      {
        id: 6,
        title: "Market volatility prediction for tech sector",
        location: [-118.2437, 34.0522],
        city: "Los Angeles",
        status: "pending",
        user: "@MarketGuru",
        reputation: 95,
        stake: 1200,
        confidence: 82,
        timestamp: "2024-02-05T09:00:00Z",
        hash: "0x2f6d...c4a1"
      },
      {
        id: 7,
        title: "International treaty ratification timeline",
        location: [37.6173, 55.7558],
        city: "Moscow",
        status: "verified",
        user: "@DiplomacyExpert",
        reputation: 83,
        stake: 550,
        confidence: 79,
        timestamp: "2024-02-03T13:20:00Z",
        hash: "0x6b9e...d8f2"
      },
      {
        id: 8,
        title: "Resource allocation decision outcome",
        location: [151.2093, -33.8688],
        city: "Sydney",
        status: "pending",
        user: "@ResourceTracker",
        reputation: 76,
        stake: 450,
        confidence: 68,
        timestamp: "2024-02-06T06:15:00Z",
        hash: "0x1a7c...b5e3"
      }
    ];

    // Mock Data - OSINT Feed
    const mockOSINT = [
      {
        id: 1,
        author: "@bellingcat",
        handle: "Bellingcat",
        content: "New investigation reveals coordinated disinformation campaign across 12 countries. Full report with evidence chains published.",
        timestamp: "2h ago",
        tags: ["Investigation", "Evidence", "Verification"]
      },
      {
        id: 2,
        author: "@IntelCrab",
        handle: "IntelCrab",
        content: "Breaking: Satellite imagery confirms infrastructure changes in disputed region. Cross-referenced with ground sources.",
        timestamp: "4h ago",
        tags: ["Satellite", "OSINT", "Verification"]
      },
      {
        id: 3,
        author: "@OSINTtechnical",
        handle: "OSINT Technical",
        content: "Analysis of public records shows pattern inconsistencies. Timeline reconstruction available with cryptographic proof.",
        timestamp: "6h ago",
        tags: ["Analysis", "Timeline", "Proof"]
      },
      {
        id: 4,
        author: "@AuroraIntel",
        handle: "Aurora Intel",
        content: "Crowdsourced verification of recent claims completed. 87% confidence level across multiple independent sources.",
        timestamp: "8h ago",
        tags: ["Crowdsource", "Verification", "Confidence"]
      },
      {
        id: 5,
        author: "@bellingcat",
        handle: "Bellingcat",
        content: "Digital forensics workshop outcomes: New techniques for video authentication and metadata analysis published.",
        timestamp: "10h ago",
        tags: ["Forensics", "Video", "Authentication"]
      },
      {
        id: 6,
        author: "@OSINTtechnical",
        handle: "OSINT Technical",
        content: "Tracking supply chain movements through open source intelligence. Pattern analysis reveals significant deviations.",
        timestamp: "12h ago",
        tags: ["Supply Chain", "Tracking", "Analysis"]
      }
    ];

    // Mock Data - Leaderboard
    const mockLeaderboard = [
      { rank: 1, user: "@VerifierPro", score: 95, claims: 342, accuracy: 94 },
      { rank: 2, user: "@DataMaster", score: 92, claims: 298, accuracy: 91 },
      { rank: 3, user: "@TruthSeeker", score: 90, claims: 276, accuracy: 89 },
      { rank: 4, user: "@EvidenceKing", score: 88, claims: 254, accuracy: 87 },
      { rank: 5, user: "@ClimatePro", score: 88, claims: 241, accuracy: 88 },
      { rank: 6, user: "@TechInsider", score: 85, claims: 219, accuracy: 84 },
      { rank: 7, user: "@DiplomacyExpert", score: 83, claims: 203, accuracy: 85 },
      { rank: 8, user: "@EconWatcher", score: 78, claims: 187, accuracy: 79 },
      { rank: 9, user: "@ResourceTracker", score: 76, claims: 165, accuracy: 77 },
      { rank: 10, user: "@PolicyWatch", score: 71, claims: 142, accuracy: 73 }
    ];

    // Initialize Map
    const map = new mapboxgl.Map({
      container: "map",
      style: "mapbox://styles/mapbox/dark-v11",
      projection: "globe",
      center: [15, 35],
      zoom: 1.3,
      antialias: true,
      attributionControl: false
    });

    let currentFilter = 'all';
    let heatmapVisible = false;

    // Map Style Load Handler
    map.on("style.load", () => {
      // Set fog/atmosphere
      map.setFog({
        "range": [0.5, 10],
        "color": "#000000",
        "horizon-blend": 0.05,
        "high-color": "#0a0a0a",
        "space-color": "#000000",
        "star-intensity": 0.15
      });

      // Create GeoJSON from claims
      const claimsGeoJSON = {
        type: "FeatureCollection",
        features: mockClaims.map(claim => ({
          type: "Feature",
          geometry: {
            type: "Point",
            coordinates: claim.location
          },
          properties: {
            ...claim
          }
        }))
      };

      // Add claims source
      map.addSource("claims", {
        type: "geojson",
        data: claimsGeoJSON
      });

      // Add glow layer
      map.addLayer({
        id: "claims-glow",
        type: "circle",
        source: "claims",
        paint: {
          "circle-radius": [
            "interpolate",
            ["linear"],
            ["zoom"],
            1, 25,
            5, 90,
            10, 130
          ],
          "circle-color": [
            "match",
            ["get", "status"],
            "verified", "#28A745",
            "disputed", "#DC3545",
            "#FFC107"
          ],
          "circle-opacity": 0.2,
          "circle-blur": 1
        }
      });

      // Add core markers
      map.addLayer({
        id: "claims-core",
        type: "circle",
        source: "claims",
        paint: {
          "circle-radius": [
            "interpolate",
            ["linear"],
            ["zoom"],
            1, 8,
            5, 16,
            10, 24
          ],
          "circle-color": [
            "match",
            ["get", "status"],
            "verified", "#28A745",
            "disputed", "#DC3545",
            "#FFC107"
          ],
          "circle-opacity": 0.9,
          "circle-stroke-width": 2,
          "circle-stroke-color": "#ffffff",
          "circle-stroke-opacity": 0.8
        }
      });

      // Add heatmap layer (initially hidden)
      map.addLayer({
        id: "claims-heatmap",
        type: "heatmap",
        source: "claims",
        paint: {
          "heatmap-weight": ["get", "confidence"],
          "heatmap-intensity": 1,
          "heatmap-color": [
            "interpolate",
            ["linear"],
            ["heatmap-density"],
            0, "rgba(0, 0, 255, 0)",
            0.2, "#9333ea",
            0.4, "#a78bfa",
            0.6, "#c084fc",
            0.8, "#e9d5ff",
            1, "#ffffff"
          ],
          "heatmap-radius": 50,
          "heatmap-opacity": 0.8
        },
        layout: {
          "visibility": "none"
        }
      });

      // Marker click handlers
      map.on("click", "claims-core", (e) => {
        const feature = e.features[0];
        const props = feature.properties;

        const popupHTML = `
          <div class="popup-title">${props.title}</div>
          <div class="popup-info">
            <strong>Location:</strong> ${props.city}<br>
            <strong>Submitter:</strong> ${props.user} <span class="reputation-badge"><i class="fas fa-star"></i> ${props.reputation}</span><br>
            <strong>Hash:</strong> <code>${props.hash}</code>
          </div>
          <div class="popup-stats">
            <div class="popup-stat">
              <div class="popup-stat-value">${props.stake}</div>
              <div class="popup-stat-label">Tokens Staked</div>
            </div>
            <div class="popup-stat">
              <div class="popup-stat-value">${props.confidence}%</div>
              <div class="popup-stat-label">Confidence</div>
            </div>
          </div>
          <div class="popup-actions">
            <button class="popup-btn popup-btn-primary" onclick="viewEvidence(${props.id})">
              <i class="fas fa-link"></i> View Evidence
            </button>
            <button class="popup-btn popup-btn-secondary" onclick="challengeClaim(${props.id})">
              <i class="fas fa-gavel"></i> Challenge
            </button>
          </div>
        `;

        new mapboxgl.Popup({
          offset: 25,
          closeButton: true,
          closeOnClick: false
        })
          .setLngLat(feature.geometry.coordinates)
          .setHTML(popupHTML)
          .addTo(map);
      });

      // Hover cursor
      map.on("mouseenter", "claims-core", () => {
        map.getCanvas().style.cursor = "pointer";
      });

      map.on("mouseleave", "claims-core", () => {
        map.getCanvas().style.cursor = "";
      });

      // Auto-rotation when idle
      map.on("idle", () => {
        if (map.getZoom() < 2) {
          map.rotateTo(map.getBearing() + 10, { duration: 60000 });
        }
      });
    });

    // UI Functions
    function toggleSidebar() {
      const sidebar = document.getElementById("claimsSidebar");
      sidebar.classList.toggle("open");
    }

    function toggleLayer(type) {
      currentFilter = type;
      updateGlobeControls();

      if (type === 'all') {
        map.setFilter("claims-core", null);
        map.setFilter("claims-glow", null);
      } else if (type === 'verified') {
        map.setFilter("claims-core", ["==", ["get", "status"], "verified"]);
        map.setFilter("claims-glow", ["==", ["get", "status"], "verified"]);
      }
    }

    function toggleHeatmap() {
      heatmapVisible = !heatmapVisible;
      map.setLayoutProperty(
        "claims-heatmap",
        "visibility",
        heatmapVisible ? "visible" : "none"
      );
      map.setLayoutProperty(
        "claims-core",
        "visibility",
        heatmapVisible ? "none" : "visible"
      );
      map.setLayoutProperty(
        "claims-glow",
        "visibility",
        heatmapVisible ? "none" : "visible"
      );
      updateGlobeControls();
    }

    function resetView() {
      map.flyTo({
        center: [15, 35],
        zoom: 1.3,
        duration: 2000
      });
    }

    function updateGlobeControls() {
      document.querySelectorAll('.globe-control-btn').forEach(btn => {
        btn.classList.remove('active');
      });
    }

    function filterClaims(status) {
      document.querySelectorAll('.filter-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      event.target.classList.add('active');

      renderClaims(status);
    }

    function renderClaims(filter = 'all') {
      const claimsList = document.getElementById("claimsList");
      const filtered = filter === 'all'
        ? mockClaims
        : mockClaims.filter(c => c.status === filter);

      claimsList.innerHTML = filtered.map(claim => `
        <div class="claim-card ${claim.status}" onclick="flyToClaim(${claim.location[0]}, ${claim.location[1]})">
          <div class="claim-header">
            <div class="claim-title">${claim.title}</div>
            <span class="claim-status status-${claim.status}">${claim.status}</span>
          </div>
          <div class="claim-meta">
            <div class="claim-meta-item">
              <i class="fas fa-user"></i> ${claim.user}
            </div>
            <div class="claim-meta-item">
              <span class="reputation-badge"><i class="fas fa-star"></i> ${claim.reputation}</span>
            </div>
            <div class="claim-meta-item">
              <i class="fas fa-coins"></i> ${claim.stake}
            </div>
          </div>
          <div class="claim-evidence">
            <button class="evidence-btn" onclick="event.stopPropagation(); viewEvidence(${claim.id})">
              <i class="fas fa-link"></i> Evidence
            </button>
            <button class="evidence-btn" onclick="event.stopPropagation(); alert('Hash: ${claim.hash}')">
              <i class="fas fa-hashtag"></i> Hash
            </button>
          </div>
        </div>
      `).join('');
    }

    function renderOSINT() {
      const osintFeed = document.getElementById("osintFeed");
      osintFeed.innerHTML = mockOSINT.map(post => `
        <div class="osint-card">
          <div class="osint-card-header">
            <div class="osint-avatar">${post.handle.charAt(0)}</div>
            <div class="osint-author">
              <div class="osint-handle">${post.handle}</div>
              <div class="osint-timestamp">${post.timestamp}</div>
            </div>
          </div>
          <div class="osint-content">${post.content}</div>
          <div class="osint-tags">
            ${post.tags.map(tag => `<span class="osint-tag">#${tag}</span>`).join('')}
          </div>
          <div class="osint-actions">
            <button class="osint-btn" onclick="alert('Creating claim from OSINT post')">
              <i class="fas fa-plus"></i> Create Claim
            </button>
            <button class="osint-btn" onclick="window.open('https://x.com/${post.author}', '_blank')">
              <i class="fas fa-external-link-alt"></i> View Source
            </button>
          </div>
        </div>
      `).join('');
    }

    function openLeaderboard() {
      const modal = document.getElementById("leaderboardModal");
      const tbody = document.getElementById("leaderboardBody");

      tbody.innerHTML = mockLeaderboard.map(entry => `
        <tr>
          <td><span class="rank-badge ${entry.rank <= 3 ? 'top' : ''}">${entry.rank}</span></td>
          <td><strong>${entry.user}</strong></td>
          <td>${entry.score}</td>
          <td>${entry.claims}</td>
          <td>${entry.accuracy}%</td>
        </tr>
      `).join('');

      modal.classList.add("open");
    }

    function closeLeaderboard() {
      document.getElementById("leaderboardModal").classList.remove("open");
    }

    function flyToClaim(lng, lat) {
      map.flyTo({
        center: [lng, lat],
        zoom: 8,
        duration: 2000
      });
    }

    function viewEvidence(id) {
      alert(`Viewing evidence for claim #${id}\nThis would open the evidence details page with cryptographic proof, timestamps, and blockchain verification.`);
    }

    function challengeClaim(id) {
      alert(`Challenging claim #${id}\nThis would open a form to submit counter-evidence and stake tokens on your dispute.`);
    }

    // Initialize UI
    renderClaims();
    renderOSINT();

    // Close modal on outside click
    window.onclick = function(event) {
      const modal = document.getElementById("leaderboardModal");
      if (event.target === modal) {
        closeLeaderboard();
      }
    }
  </script>

</body>
</html>